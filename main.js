(()=>{"use strict";class t{constructor(t,e){this.shipType=t,this.shipLength=e,this.hitCount=0,this.isSunk=!1}hit(){this.hitCount<this.shipLength&&(this.hitCount++,this.hitCount===this.shipLength&&(this.isSunk=!0))}updateSunkStatus(){this.hitCount===this.shipLength&&(this.isSunk=!0)}}function e(e,a,r,s=null){const n=document.getElementById(e);n.innerHTML="";for(let e=0;e<a;e++)for(let a=0;a<r;a++){const r=document.createElement("div");r.className="board-cell",r.dataset.row=e,r.dataset.column=a,s&&s.board[e][a]instanceof t&&r.classList.add("player-ship"),n.appendChild(r)}}function a(e,a){for(let r=0;r<a.rows;r++)for(let s=0;s<a.columns;s++){const n=document.querySelector(`#${e} .board-cell[data-row="${r}"][data-column="${s}"]`);a.board[r][s]instanceof t&&n.classList.add("player-ship")}}function r(t,e){const a=document.querySelector(".winner-info"),r=document.getElementById("game-end-dialog"),s=document.querySelector(".game-end-dialog-container");a.textContent=t===e?"You won!":"You lose",s.style.display="flex",r.showModal()}function s(t,e){"hit"===e?t.classList.add("cell-hit"):"miss"===e&&t.classList.add("cell-miss")}function n(t,e,a){t.target.className.includes("board-cell")&&function(t,e,a,r){i();for(let s=0;s<a;s++){const a=r?document.querySelector(`#placement-gameboard .board-cell[data-row="${t}"][data-column="${e+s}"]`):document.querySelector(`#placement-gameboard .board-cell[data-row="${t+s}"][data-column="${e}"]`);a&&a.classList.add("ship-hover")}}(parseInt(t.target.dataset.row,10),parseInt(t.target.dataset.column,10),e.shipLength,a)}function o(){i()}function i(){document.querySelectorAll("#placement-gameboard .board-cell.ship-hover").forEach((t=>{t.classList.remove("ship-hover")}))}class l{constructor(){this.rows=10,this.columns=10,this.board=this.createBoard()}createBoard(){const t=[];for(let e=0;e<this.rows;e++){t[e]=[];for(let a=0;a<this.columns;a++)t[e][a]=null}return t}placeShip(t,e,a,r=!0){if(r){let r=!0;for(let s=0;s<t.shipLength;s++)if(a+s>=this.columns||null!==this.board[e][a+s]){r=!1;break}if(r){for(let r=0;r<t.shipLength;r++)this.board[e][a+r]=t;return!0}}if(!r){let r=!0;for(let s=0;s<t.shipLength;s++)if(e+s>=this.rows||null!==this.board[e+s][a]){r=!1;break}if(r){for(let r=0;r<t.shipLength;r++)this.board[e+r][a]=t;return!0}}return!1}getShipCoordinates(){const e=[];for(let a=0;a<this.rows;a++)for(let r=0;r<this.columns;r++)this.board[a][r]instanceof t&&e.push({row:a,col:r});return e}isAttackValid(t,e){return t>=0&&t<this.rows&&e>=0&&e<this.columns}markCellAsAttacked(t,e,a){this.board[t][e]=a}receiveAttack(e,a){if(!this.isAttackValid(e,a))return!0;const r=this.board[e][a];return"hit"!==r&&"miss"!==r&&(r instanceof t?(r.hit(),this.markCellAsAttacked(e,a,"hit"),!0):(this.markCellAsAttacked(e,a,"miss"),!0))}areAllShipsSunk(){for(let e=0;e<this.rows;e++)for(let a=0;a<this.columns;a++){const r=this.board[e][a];if(r instanceof t&&!r.isSunk)return!1}return!0}}class c{constructor(t,e){this.player1=t,this.player2=e,this.currentPlayer=t}initializeGame(){this.player1.setGameBoard(new l),this.player2.setGameBoard(new l),this.placeAiShips()}placeAiShips(){[new t("Carrier",5),new t("Battleship",4),new t("Destroyer",3),new t("Submarine",3),new t("Patrol Boat",2)].forEach((t=>{let e=!1;for(;!e;){const a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),s=Math.random()>.5;e=this.player2.gameBoard.placeShip(t,a,r,s)}}))}switchPlayer(){this.currentPlayer=this.currentPlayer===this.player1?this.player2:this.player1}checkWin(){return this.player1.gameBoard.areAllShipsSunk()?this.player2.name:this.player2.gameBoard.areAllShipsSunk()?this.player1.name:null}}class d{constructor(t){this.name=t,this.gameBoard=null}setGameBoard(t){this.gameBoard=t}sendAttack(t,e,a){return a.receiveAttack(t,e)}}class h extends d{constructor(t){super(t),this.attackedCoordinates=Array(10).fill(null).map((()=>Array(10).fill(!1))),this.lastAttack=null}makeRandomAttack(t){let e,a;do{e=Math.floor(10*Math.random()),a=Math.floor(10*Math.random())}while(this.attackedCoordinates[e][a]);return this.attackedCoordinates[e][a]=!0,this.lastAttack=[e,a],this.sendAttack(e,a,t)}getLastAttack(){return this.lastAttack}}(new class{constructor(){this.player1=new d("Human Player"),this.player2=new h("Ai Player"),this.gameController=new c(this.player1,this.player2)}initialize(){this.gameController.initializeGame(),e("p1-gameboard",10,10,this.player1.gameBoard),e("p2-gameboard",10,10),function(r){const s=document.getElementById("ship-placement-modal"),l=document.getElementById("placement-gameboard");let c,d=0,h=!0;const m=()=>{c=[new t("Carrier",5),new t("Battleship",4),new t("Destroyer",3),new t("Submarine",3),new t("Patrol Boat",2)],d=0,h=!0,e("placement-gameboard",10,10)},u=t=>{const e=function(t,e,r,s){const n=parseInt(t.target.dataset.row,10),o=parseInt(t.target.dataset.column,10);return!!e.gameBoard.placeShip(r,n,o,s)&&(a("placement-gameboard",e.gameBoard),i(),!0)}(t,r,c[d],h);e&&(d++,d>=c.length&&s.close())},p=()=>{l.removeEventListener("mouseover",n),l.removeEventListener("mouseout",o),l.removeEventListener("click",u),l.addEventListener("mouseover",(t=>n(t,c[d],h))),l.addEventListener("mouseout",o),l.addEventListener("click",u),document.getElementById("rotate-button").onclick=()=>{h=!h}};s.addEventListener("close",(()=>{a("p1-gameboard",r.gameBoard),m(),p()})),m(),p()}(this.player1);const l=document.getElementById("ship-placement-modal");var c,d,h,m;l.showModal(),l.addEventListener("close",(()=>{a("p1-gameboard",this.player1.gameBoard)})),c="p2-gameboard",d=this.player1,h=this.player2,m=this.gameController,document.getElementById(c).addEventListener("click",(t=>function(t,e,a,n){const o=t.target;if("board-cell"!==o.className)return;const i=parseInt(o.dataset.row,10),l=parseInt(o.dataset.column,10);if(!1!==e.sendAttack(i,l,a.gameBoard)){s(o,a.gameBoard.board[i][l]);const t=n.checkWin();t?r(t,e.name):(n.switchPlayer(),setTimeout((()=>function(t,e,a){e.makeRandomAttack(t.gameBoard);const[n,o]=e.getLastAttack();s(document.querySelector(`#p1-gameboard .board-cell[data-row="${n}"][data-column="${o}"]`),t.gameBoard.board[n][o]);const i=a.checkWin();i?r(i,t.name):a.switchPlayer()}(e,a,n)),300))}}(t,d,h,m))),function(t){const e=document.getElementById("restart-button");function a(){const e=document.getElementById("game-end-dialog");document.querySelector(".game-end-dialog-container").style.display="none",e.close(),t.initialize()}e.removeEventListener("click",a),e.addEventListener("click",a)}(this)}}).initialize()})();
//# sourceMappingURL=main.js.map